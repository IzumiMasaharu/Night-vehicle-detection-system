
# 低光照图像增强与YOLOv8目标检测

## 概述

本项目结合低光照图像增强算法（LIME）和YOLOv8目标检测模型，旨在提高低光照条件下的目标检测性能。该系统处理输入的图像和视频，增强图像质量，并检测关键目标（如车辆），这对自动驾驶等应用至关重要。

### 主要特点：
- **低光照图像增强**：采用自校准照明（SCI）方法增强低光照条件下的图像质量。
- **YOLOv8目标检测**：增强后对图像进行目标检测，即使在低光照环境下也能提供准确的检测结果。
- **实时检测**：支持实时视频流处理，增强后的检测性能更加出色。
- **多线程支持**：通过多线程加速处理，提高处理速度。

## 安装

1. 克隆仓库：
   ```bash
   git clone https://github.com/ouweibiao/Night-vehicle-detection-system.git
   cd Night-vehicle-detection-system
   ```

2. 安装所需依赖：
   ```bash
   pip install -r requirements.txt
   ```

3. 确保你的硬件支持实时处理和多线程（例如，多核CPU）。

## 使用方法

处理图像或视频：

1. **图像增强与检测**：
   ```bash
   python detect.py --input_image path_to_your_image
   ```

2. **实时视频流检测**：
   ```bash
   python detect.py --input_stream camera
   ```

3. **批量视频处理**：
   ```bash
   python detect.py --input_video path_to_video --output_video path_to_output
   ```

`detect.py`脚本将自动增强图像并使用YOLOv8模型进行目标检测。

## 算法介绍

### 1. **低光照图像增强（LIME）**：
   SCI框架通过调整光照分布来增强图像的可见性，提高图像质量，从而获得更好的特征提取效果。

### 2. **YOLOv8目标检测**：
   YOLOv8是一种单阶段检测算法，直接从输入图像中检测目标。它将图像划分为网格，每个网格预测目标的边界框和类别概率。

### 3. **优化措施**：
   - 多线程并行处理，提高检测速度。
   - 通过图像增强提高检测精度。

## 结果展示

### 图像对比：
- **未增强**：由于低光照条件，目标检测可能遗漏关键目标。
- **增强后**：图像质量提升，检测性能得到了改善。

### 性能：
- **单线程处理时间**：1475.28秒。
- **四线程处理时间**：1369.06秒。

## 未来改进

- **多核与NEON加速**：利用多核处理器和NEON加速进一步提高性能。
- **扩展训练次数**：将训练次数从100增加到500，提高精度。
- **追踪功能**：增加目标追踪功能，进一步优化检测过程。

## 许可证

本项目采用MIT许可证 - 详情请参阅 [LICENSE](LICENSE) 文件。
